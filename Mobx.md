# Mobx

æå‡ºé—®é¢˜ï¼š

Mobxä¼šå¯¹ä»€ä¹ˆåšå‡ºååº”ï¼Ÿ

	â€˜è¯»å–â€™æ˜¯å¯¹å¯¹è±¡å±æ€§çš„é—´æ¥å¼•ç”¨ï¼Œå¯ä»¥ç”¨.æˆ–è€…[]çš„å½¢å¼å–åˆ°è¿™äº›å±æ€§å€¼
	â€˜è¿½è¸ªå‡½æ•°â€™æ˜¯computedè¡¨è¾¾å¼ã€observerç»„ä»¶çš„render()æ–¹æ³•å’Œwhenã€reactionå’Œautorunçš„ç¬¬ä¸€ä¸ªå…¥å‚å‡½æ•°
	â€˜è¿‡ç¨‹â€™æ„å‘³ç€åªè¿½è¸ªé‚£äº›åœ¨å‡½æ•°æ‰§è¡Œæ—¶è¢«è¯»å–çš„observerble
Mobx: ç®€å•ã€å¯æ‰©å±•çš„çŠ¶æ€ç®¡ç†å·¥å…·ã€‚å®ƒé€šè¿‡é€æ˜çš„å‡½æ•°å“åº”å¼ç¼–ç¨‹ï¼Œä½¿å¾—çŠ¶æ€ç®¡ç†å˜å¾—ç®€å•å’Œå¯æ‰©å±•ã€‚MobxèƒŒåçš„å“²å­¦å¾ˆç®€å•ï¼šä»»ä½•æºè‡ªåº”ç”¨çŠ¶æ€çš„ä¸œè¥¿éƒ½åº”è¯¥è‡ªåŠ¨åœ°è·å¾—ã€‚åŒ…æ‹¬UIã€æ•°æ®åºåˆ—åŒ–ã€æœåŠ¡å™¨é€šè®¯ç­‰ã€‚

Reactå’ŒMobxæ˜¯ä¸€å¯¹å¼ºåŠ›ç»„åˆã€‚Reacté€šè¿‡æä¾›æœºåˆ¶æŠŠåº”ç”¨çŠ¶æ€è½¬æ¢ä¸ºå¯æ¸²æŸ“ç»„ä»¶æ ‘å¹¶å¯¹å…¶è¿›è¡Œæ¸²æŸ“ã€‚è€ŒMobxæä¾›æœºåˆ¶æ¥å­˜å‚¨å’Œæ›´æ–°åº”ç”¨çŠ¶æ€ä¾›Reactä½¿ç”¨ã€‚å¯¹äºåº”ç”¨å¼€å‘ä¸­çš„å¸¸è§é—®é¢˜ï¼ŒReactå’Œmobxéƒ½æä¾›äº†æœ€ä¼˜å’Œç‹¬ç‰¹çš„è§£å†³æ–¹æ¡ˆã€‚Reactæä¾›äº†ä¼˜åŒ–UIæ¸²æŸ“çš„æœºåˆ¶ï¼Œè¿™ç§æœºåˆ¶å°±æ˜¯é€šè¿‡ä½¿ç”¨è™šæ‹ŸDOMæ¥å‡å°‘æ˜‚è´µçš„DOMå˜åŒ–æ•°é‡ï¼ŒMobxæä¾›äº†ä¼˜åŒ–åº”ç”¨çŠ¶æ€ä¸Reactç»„ä»¶åŒæ­¥çš„æœºåˆ¶ï¼Œè¿™ç§æœºåˆ¶å°±æ˜¯ä½¿ç”¨å“åº”å¼è™šæ‹Ÿä¾èµ–çŠ¶æ€å›¾æ ‡ï¼Œå®ƒåªæœ‰åœ¨çœŸæ­£éœ€è¦çš„æ—¶å€™æ‰æ›´æ–°å¹¶ä¸”æ°¸è¿œä¿æŒæ˜¯æœ€æ–°çš„ã€‚

### Observable state(å¯è§‚å¯Ÿçš„çŠ¶æ€)
MobXä¸ºç°æœ‰çš„æ•°æ®ç»“æ„ï¼ˆå¦‚å¯¹è±¡ï¼Œæ•°ç»„å’Œç±»å®ä¾‹ï¼‰æ·»åŠ äº†å¯è§‚å¯Ÿçš„åŠŸèƒ½ã€‚é€šè¿‡ä½¿ç”¨@observableè£…é¥°å™¨æ¥ç»™ä½ çš„ç±»å±æ€§æ·»åŠ æ³¨è§£å°±å¯ä»¥ç®€å•å®Œæˆ

ğŸŒ°

		import { observable } from â€˜mobxâ€™;
		
		class Todo{
			id = Math.random();
			@observable title = â€˜â€™;
			@observable finished = false
		}

ä½¿ç”¨observableå¾ˆåƒæŠŠå¯¹è±¡çš„å±æ€§å˜æˆexcelçš„å•å…ƒæ ¼ï¼Œä½†å’Œå•å…ƒæ ¼ä¸åŒçš„æ˜¯ï¼Œè¿™äº›å€¼ä¸åªæ˜¯åŸå§‹å€¼ï¼Œè¿˜å¯ä»¥æ˜¯å¼•ç”¨å€¼ï¼Œæ¯”å¦‚å¯¹è±¡å’Œæ•°ç»„ã€‚

### Computed value(è®¡ç®—å€¼)
ä½¿ç”¨MobX,ä½ å¯ä»¥å®šä¹‰åœ¨ç›¸å…³æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶è‡ªåŠ¨æ›´æ–°çš„å€¼ï¼Œé€šè¿‡@computed è£…é¥°å™¨æˆ–è€…åˆ©ç”¨(extend)Observableæ—¶è°ƒç”¨çš„getter/setterå‡½æ•°æ¥è¿›è¡Œä½¿ç”¨ã€‚

ğŸŒ°

	class TodoList {
		@observable todos = []
		@computed get unfinishedTodoCount() {
			return this.todos.filter(todo => !todo.finished).length;
		}
	}
	å½“æ·»åŠ ä¸€ä¸ªæ–°çš„todoæˆ–è€…æŸä¸ªtodoçš„finishedå±æ€§å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒMobXä¼šç¡®ä¿unfinishedTodoCountè‡ªåŠ¨æ›´æ–°ã€‚åƒè¿™æ ·çš„è®¡ç®—å¯ä»¥ç±»ä¼¼äºMS Excelè¿™æ ·ç”µå­è¡¨æ ¼ç¨‹åºä¸­çš„å…¬å¼ï¼Œæ¯å½“åªæœ‰åœ¨éœ€è¦å®ƒä»¬çš„æ—¶å€™ï¼Œå®ƒä»¬æ‰ä¼šè‡ªåŠ¨æ›´æ–°ã€‚

## æ ¸å¿ƒAPI
### åˆ›å»ºobservables
observable(value)

ç”¨æ³•ï¼šÂ· observable(value)						  Â· @observable classProperty =  value

Observableå€¼å¯ä»¥æ˜¯JSåŸºæœ¬æ•°æ®ç±»å‹ã€å¼•ç”¨ç±»å‹ã€æ™®é€šå¯¹è±¡ã€ç±»å®ä¾‹ã€æ•°ç»„å’Œæ˜ å°„ã€‚

### å®ç”¨å·¥å…·
Provider(mobx-reactåŒ…)ï¼šå¯ä»¥ç”¨æ¥ä½¿ç”¨Reactçš„contextæœºåˆ¶æ¥ä¼ é€’storeç»™å­ç»„ä»¶ã€‚

inject(mobx-reactåŒ…)ï¼šç›¸å½“äºproviderçš„é«˜é˜¶ç»„ä»¶ï¼Œå¯ä»¥ç”¨æ¥ä»Reactçš„contextä¸­æŒ‘é€‰storeä½œä¸ºpropä¼ é€’ç»™ç›®æ ‡ç»„ä»¶ã€‚

toJSï¼štoJS(observableDataStructure,options?).æŠŠobservableæ•°æ®ç»“æ„è½¬æ¢æˆæ™®é€šçš„jså¯¹è±¡å¹¶å¿½ç•¥è®¡ç®—å€¼ã€‚

	optionsåŒ…æ‹¬ï¼š
	Â· detectCycles: booleanï¼šæ£€æŸ¥observableæ•°æ®ç»“æ„ä¸­çš„å¾ªç¯å¼•ç”¨ã€‚é»˜è®¤ä¸ºtrue
	Â· exportMapAsObject: boolean: å°†ES6 Mapä½œä¸ºæ™®é€šå¯¹è±¡å¯¼å‡ºã€‚é»˜è®¤ä¸ºtrue

isArrayLike: ç”¨æ³•ï¼šisAction(func),å¦‚æœç»™å®šå‡½æ•°æ˜¯ç”¨actionæ–¹æ³•åŒ…è£¹çš„æˆ–è€…æ˜¯ç”¨@acctionè£…é¥°çš„è¯ï¼Œè¿”å›true.

isComputedæˆ–isComputedProp: ç”¨æ³•ï¼šisComputed(thing)æˆ–isComputedProp(thing,property?).å¦‚æœç»™å®šçš„thingæ˜¯è®¡ç®—å€¼æˆ–è€…thingæŒ‡å®šçš„propertyæ˜¯è®¡ç®—å€¼çš„è¯ï¼Œè¿”å›trueã€‚

intercept: ç”¨æ³•ï¼šintercept(object,property?, interceptor),è¿™ä¸ªAPIå¯ä»¥åœ¨åº”ç”¨observableçš„APIä¹‹å‰ï¼Œæ‹¦æˆªæ›´æ”¹ã€‚å¯¹äºéªŒè¯ã€æ ‡å‡†åŒ–å’Œå–æ¶ˆç­‰æ“ä½œååˆ†æœ‰ç”¨ã€‚

observe: ç”¨æ³•ï¼šobserve(object,property?,listener,fireImmediately = false)è¿™æ˜¯ä¸€ä¸ªåº•å±‚APIï¼Œç”¨æ¥è§‚å¯Ÿä¸€ä¸ªå•ä¸ªçš„observableå€¼ã€‚
	




	
